cmd="nodetool cfstats"
prefix="$(date +%Y%m%d%H%M%S)_$(hostname)"; ${cmd}  | grep -v -e "^$" | sed -e 's/\t/ /g; s/\([^:, ]\)\s\(\S\)/\1_\2/g; s/\([:,]\) /\1/g; s/ \{2,\}/ /g; s/^ //' | awk -F: 'BEGIN{k=""; t=""} $1=="Table"{t=$2} $1=="Keyspace"{k=$2} {if (k!="" && t!="") print "'${prefix}'",k,t,$1,$2; else print "'${prefix}'",k,$1,$2}' | column -t
